<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>brolwser</title>
    
    <link rel="stylesheet" href="assets/main/brolwser.css" />
    <script type="text/javascript" src="assets/main/brolwser.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://use.fontawesome.com/8acaad629b.js"></script><link href="https://use.fontawesome.com/8acaad629b.css" media="all" rel="stylesheet"><link href="https://use.fontawesome.com/8acaad629b.css" media="all" rel="stylesheet">
  </head>
  
  <body id="body" style="margin: 5em; font-family: 'Open Sans', sans-serif; background-color: white; color: white; transition: opacity 1s, background-color 2s; opacity: 0.0;">
    <div id="content">
        <div id="browser" class="resizable" style="">
            <span id="browser-dragger" style="font-size: 14px; font-weight: bold; padding-left: 10px;">brolwser overlay</span>
            <div id="browser-frame" style="border: none; width: 100%; height: 95%;">
                <input type="text" id="browser-frame-url" style="width: 90%"></input>
                <webview id="border-frame-browser" style="border: none; width: 100%; height: 100%;" src="https://google.com"></webview>
            </div>
        </div>
    </div>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </body>
    <style>
    #browser {
        background-color: white;
        color: black;
        padding: 3px;
        padding-bottom: 1em;
        padding-left: .5em;
        padding-right: .5em;
        position: absolute;
        z-index: 9;
        resize: both;
        overflow: hidden;
        height: 80%;
        width: 90%;
    }

    #browser-dragger {
        padding: 10px;
        cursor: move;
        z-index: 10;
    }
    </style>
    <script>
// Draggers
//Make the DIV element draggagle:
function dragElement(elmnt) {
    var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
    if (document.getElementById(elmnt.id + "-dragger")) {
      /* if present, the header is where you move the DIV from:*/
      document.getElementById(elmnt.id + "-dragger").onmousedown = dragMouseDown;
    } else {
      /* otherwise, move the DIV from anywhere inside the DIV:*/
      elmnt.onmousedown = dragMouseDown;
    }
    $('.resizable').resizable({
        //aspectRatio: true, //comment or remove this
        handles: 'ne, se, sw, nw'
    });
  
    function dragMouseDown(e) {
        e = e || window.event;
        e.preventDefault();
        // get the mouse cursor position at startup:
        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
    }

    function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:
        elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
    }

    function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
    }
}
    </script>
    <script>
    try {
        const {ipcRenderer} = require('electron');
        
        function log(m) {
            console.log(m);
            try {
                ipcRenderer.send('log', m);
            } catch(e) {}
        }
        
        function register(elementid) {
            var elem = document.getElementById(elementid);
            dragElement(elem);
        }
        
        function go() {
            // stuff
            var body = document.getElementById('body');
            body.style.opacity = "1.0";
            body.style.backgroundColor = "black";
            window.onunload = () => {
                body.style.backgroundColor = "white";
            };
            
            register("browser");
        }
        
        var commTo = ipcRenderer.send('pingelectron', 'ping');
    
        ipcRenderer.on('pingback', (event, arg) => {
            log('Ping:' + arg);
            go();
        });
    } catch(e) { console.log(e); }
  </script>
</html>